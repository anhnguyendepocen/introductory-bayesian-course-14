---
title: "Introductory Bayesian Course"
author: "Dr. Joseph L. Thorley"
date: "September 18^th^, 2014"
output:
  pdf_document:
    number_sections: yes
    toc: yes
  html_document:
    keep_md: yes
    toc: yes
---

```{r,echo = FALSE, results='asis'}

library(knitr)
opts_chunk$set(tidy = TRUE)
options(width = 70)

exercise_number <- 0
exercise <- function (txt) {
  exercise_number <<- exercise_number + 1
  cat(paste0("\n**Exercise** ", exercise_number), paste0("*", txt, "*\n"))
}

ktable <- function (...) {
  x <- c(...)
  mat <- matrix(NA, nrow = length(x), ncol = 2)
  mat[, 1] <- names(x)
  mat[, 2] <- x
  colnames(mat) <- mat[1,]
  mat <- mat[-1, , drop = FALSE]
  mat <- mat[order(mat[, 1, drop = TRUE]), , drop = FALSE]
  cat("\n")
  cat(kable(mat, row.names = FALSE, output = FALSE), sep = "\n")
  cat("\n")
}

options(repos = c("CRAN" = "http://cran.rstudio.com"))

fig_width <- 4
fig_height <- fig_width

fn = local({
  i <- 0
  function(x) {
    i <<- i + 1
    paste0("Figure ", i, ": ", x)
  }
})

```

# Background

The purpose of these course notes is to introduce participants to Bayesian analysis with R and JAGS.

The notes, which are released under a [CC BY 4.0](http://creativecommons.org/licenses/by/4.0/deed.en_US) license, are a draft of the material to be presented at the [Introductory Bayesian Course](/courses/2014/04/02/bayesian-course.html) in Kelowna on November 20^th^-21^st^, 2014. They were written by [Dr. Joseph Thorley R.P.Bio.](http://www.poissonconsulting.ca/people/joe-thorley.html).

## Statistical Analysis

Statistical analysis uses probability models 
to provide bounded estimates of parameter values 
($\theta$) from the data ($D$).

There are two primary approaches to statistical analysis: Bayesian and frequentist. As far as a frequentist is concerned the best estimates of $\theta$ are those values that maximise the *likelihood* ($P(D|\theta)$). 
A Bayesian on the other hand chooses the values with the highest *posterior* probabilities ($P(\theta|D)$). There are several major consequences of this choice. 

Firstly, Bayesians need to provide a *prior* probability distribution for $\theta$ because (as **Bayes** theorem demonstrates) $P(\theta|D) \propto P(D|\theta)P(\theta)$. Bayesians consider
this an advantage because prior information can be incorporated into an analysis while frequentists consider it subjective. In most cases Bayesians use low-information priors which have little effect on the posteriors.

Secondly, a frequentist 95% *confidence interval* (CI) is expected to include the underlying value of $\theta$ 95% of the time. A Bayesian 95% *credible interval* (CRI), on the other hand, has a 95% probability of including the true
value of $\theta$. The difference is subtle but important. For example, the
the reliability of a frequentist confidence interval depends on *sufficient* sample size - a Bayesian credible interval does not.

The third major consequence is that although likelihood functions can be derived 
for many models (and therefore used to quickly find the maximum likelihood estimates),
it is typically not possible to produce formulas to calculate the posterior probababilities.
For many years this severely limited the use of Bayesian statistics... until people realised
that the posterior probability distributions can be estimated using Gibbs Sampling.


### Gibbs Sampling

Thirdly, requirement Gibbs.....

The development of the BUGS language was a major step because it means 
that can specify complex models by simply describing the stochastic and deterministic
relationships between data and parameters.


```{r}
library(rjags)

```



As a general rule, 

Gibbs Sampling....

Updating.

## R

[R](http://www.r-project.org/) and S-PLUS are implementation of the S language which is a language for 'programming with data'. R is free and open source. S-PLUS is not.

## JAGS

JAGS, WinBUGS and OpenBUGS are implementations of the BUGS language which is a language for describing statistical models. JAGS is an acronym for Just Another Gibbs Sampler. BUGS stands for Bayesian Analysis using Gibbs Sampling. Gibbs Sampling is explained below. JAGS is free, open source, multi-platform and written in C++. WinBUGS is closed source and Windows only. OpenBUGS is not available for OSX and is written in Component Pascal a [dead-end language](http://bayesiancomputation.wordpress.com/2010/06/19/openbugs-vs-jags/).

## Installation

Download the the most recent version of the base distribution binary for your platform from <http://cran.r-project.org/> and install using the default options. Then start up R.

